方案内容：
1 CDH数据安全方案设计
2 数据安全方案实施
3 数据权限划分要点
4 安全方案实施对现有集群的影响
5 安全方案的运维
6 其他可能的安全需求

1 方案准备说明
方案基于CD6.3进行设计；原则上以实现数据授权为目标，兼顾运维需求。
前置条件：
1）	因为是内网，可以不做通信加密（TSL）；
2）	在满足基本权限要求的前提下，可以考虑使用LDAP做用户管理。
3）	可以考虑使用集成的开源工具，如FreeIPA。
2 安全方案需求
1）	实现细粒度的权限管控；
2）	数据对象的通配符筛选；
3）	CDH数据接口尽可能覆盖；
4）	合理的运维操作与支持；
5）	体系的高可用性；
3 安全方案设计
3.1 方案设计
采用MIT Kerberos + Sentry + openLADP 方案。Kerberos实现所用用户以及服务间的身份认证，LDAP实现用户管理，Sentry用来做授权。
3.2 高可用设计
Sentry本身支持高可用部署，可以部署两个Sentry Server；
KDC也支持主备部署，安装时默认采用2分钟的同步间隔。多个KDC可同时作为备份，当MasterKDC 失败后，从KDC将自动提供认证服务，此时对已有的账户认证不受影响，但是不能做新增操作。
所有对KDC的所作都记录在MasterKDC节点，这个操作需要手动同步到其他从KDC节点。
Kadmin进程提供了远程kadmin服务，若此服务失败，不能通过管理客户端kadmin进行管理命令操作，但是仍然可以在Master本地启动kadmin.local 进程进行操作，同时，数据会直接写入本地数据库文件中，不受krb5kdc进程影响。  

3.3安全方案对现有HDFS的影响
1）采用安全方案时，HDFS开启权限认证模式，访问HDFS文件需要匹配HDFS的访问控制权限。
2）Sentry会同步当前HDFS的ACL信息，
Sentry权限设计只对HiveSQL/impala有效， Sentry也可以对HDFS特定目录生效（对Hive SQL生效，通过其他方式访问HDFS目录的，只能通过HDFS ACL配置权限）。
3）所有的客户端访问HDFS/Hive/impala时需要提前初始化kerberos票据。
4）Sentry授权只能对用户组授权，授权最细粒度为列Column。
5）Hue的用户与Linux用户是按名称对应的，但是需要手动创建，不能自动识别。
6）所有的Hadoop客户端都需要做Kerberos适配。
