问题描述
DataNode写入数据时，有一个节点出现不定时的网络连接中断异常，具体指其他节点无法连接到他的50010端口，
它自身也无法连接到其他节点的端口，Log中提示超时65s导致连接中断。

问题排查：
第一步
该节点ping  其他节点显示网络正常。
数据写入正常，数据没有丢失，网络中断后悔自动尝试重连。
检查网卡设置，无异常，与其他节点的设置是一样的；
#sysctl  -a | grep net
检查带宽，发现无异常；
#ethtool  bond0
检查文件传输速度
#scp  frompath    targetPath
发现网速无异常

以上检查没有发现网络异常故障。

第二步：
想办法问题重现，并做抓包分析

准备一个大文件（32G），从本地上传到HDFS，此时会有一份备份数据写在本地。
同时监听50010 数据服务端口的所有数据包；
#tcpdump -i bond0  port  50010 
#tcpdump -i bond0  port  50010 -n -w file.w  收集二进制文件
显示的结果中FLAG 为 [.]  这里的‘.’ 表示ACK，指一般的确认。同时[S] 表示SYNC。[PUSH.] 表示数据发送包。
数据包的发送规则如TCP规则，每一个数据包带有Seq序列号。每一次的发送都伴随着以及回复确认。
file.w 文件的数据可以通过wireshark 分析

通过抓包分析发现，在节点通信中，存在中偶然的丢包现象，直接表现为从问题节点发出的数据包没有得到回复，出发TCP重发机制，在多次重发发送尝试仍然
没有收到确认反馈后，TCP确认网络已中断，会重新发起连接，整个重发等待的时间总共大概为60S。
到此怀疑主机的网卡、网络、或者硬件有通信问题。

进一步通过分析其他端口。
#scp 数据文件，并监听其数据发送端口数据包
发现scp时也存在丢包无响应的问题。

#iftop  可以试试监控网络数据包。

到此推断之前的网络中断不是软件本省的问题，而是主机或者主机通信组件的故障。

多次scp测试发现其网速也有较大的波动，有事甚至降为0，但通过ping测试网络时连接仍然正常。

至此，分析分析结束，确认需要硬件维护小组进一步排查网络故障，同时将问题节点从集群的存储以及计算组中移除下线。














